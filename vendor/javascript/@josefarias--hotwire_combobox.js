// @josefarias/hotwire_combobox@0.3.2 downloaded from https://ga.jspm.io/npm:@josefarias/hotwire_combobox@0.3.2/app/assets/javascripts/hotwire_combobox.esm.js

import{Controller as e}from"@hotwired/stimulus";const t={};t.Actors=e=>class extends e{_initializeActors(){this._actingListbox=this.listboxTarget;this._actingCombobox=this.comboboxTarget}_forAllComboboxes(e){this._allComboboxes.forEach(e)}get _actingListbox(){return this.actingListbox}set _actingListbox(e){this.actingListbox=e}get _actingCombobox(){return this.actingCombobox}set _actingCombobox(e){this.actingCombobox=e}get _allComboboxes(){return[this.comboboxTarget,this.dialogComboboxTarget]}};t.Announcements=e=>class extends e{_announceToScreenReader(e,t){this.announcerTarget.innerText=`${e} ${t}`}};t.AsyncLoading=e=>class extends e{get _isAsync(){return this.hasAsyncSrcValue}get _isSync(){return!this._isAsync}};function Concerns(e,...t){return t.reduce(((e,t)=>t(e)),e)}function visible(e){return!(e.hidden||e.closest("[hidden]"))}function wrapAroundAccess(e,t){const i=0;const s=e.length-1;return t<i?e[s]:t>s?e[i]:e[t]}function applyFilter(e,{matching:t}){return i=>{if(e){const s=i.getAttribute(t)||"";const n=s.toLowerCase().includes(e.toLowerCase());i.hidden=!n}else i.hidden=false}}function cancel(e){e.stopPropagation();e.preventDefault()}function startsWith(e,t){return e.toLowerCase().startsWith(t.toLowerCase())}function debounce(e,t=150){let i=null;return(...s)=>{const callback=()=>e.apply(this,s);clearTimeout(i);i=setTimeout(callback,t)}}function isDeleteEvent(e){return e.inputType==="deleteContentBackward"||e.inputType==="deleteWordBackward"}function sleep(e){return new Promise((t=>setTimeout(t,e)))}function unselectedPortion(e){return e.selectionStart===e.selectionEnd?e.value:e.value.substring(0,e.selectionStart)}function dispatch(e,{target:t,cancelable:i,detail:s}={}){const n=new CustomEvent(e,{cancelable:i,bubbles:true,composed:true,detail:s});t&&t.isConnected?t.dispatchEvent(n):document.documentElement.dispatchEvent(n);return n}function nextRepaint(){return document.visibilityState==="hidden"?nextEventLoopTick():nextAnimationFrame()}function nextAnimationFrame(){return new Promise((e=>requestAnimationFrame((()=>e()))))}function nextEventLoopTick(){return new Promise((e=>setTimeout((()=>e()),0)))}t.Autocomplete=e=>class extends e{_connectListAutocomplete(){this._autocompletesList||this._visuallyHideListbox()}_replaceFullQueryWithAutocompletedValue(e){const t=e.getAttribute(this.autocompletableAttributeValue);this._fullQuery=t;this._actingCombobox.setSelectionRange(t.length,t.length)}_autocompleteMissingPortion(e){const t=this._typedQuery;const i=e.getAttribute(this.autocompletableAttributeValue);if(this._autocompletesInline&&startsWith(i,t)){this._fullQuery=i;this._actingCombobox.setSelectionRange(t.length,i.length)}}_visuallyHideListbox(){this.listboxTarget.style.display="none"}get _isExactAutocompleteMatch(){return this._immediatelyAutocompletableValue===this._fullQuery}get _isPartialAutocompleteMatch(){return!!this._immediatelyAutocompletableValue&&startsWith(this._immediatelyAutocompletableValue,this._fullQuery)}get _autocompletesList(){return this.autocompleteValue==="both"||this.autocompleteValue==="list"}get _autocompletesInline(){return this.autocompleteValue==="both"||this.autocompleteValue==="inline"}get _immediatelyAutocompletableValue(){return this._ensurableOption?.getAttribute(this.autocompletableAttributeValue)}};const i=3;t.Callbacks=e=>class extends e{_initializeCallbacks(){this.callbackQueue=[];this.callbackExecutionAttempts={}}_enqueueCallback(){const e=crypto.randomUUID();this.callbackQueue.push(e);return e}_isNextCallback(e){return this._nextCallback===e}_callbackAttemptsExceeded(e){return this._callbackAttempts(e)>i}_callbackAttempts(e){return this.callbackExecutionAttempts[e]||0}_recordCallbackAttempt(e){this.callbackExecutionAttempts[e]=this._callbackAttempts(e)+1}_dequeueCallback(e){this.callbackQueue=this.callbackQueue.filter((t=>t!==e));this._forgetCallbackExecutionAttempts(e)}_forgetCallbackExecutionAttempts(e){delete this.callbackExecutionAttempts[e]}get _nextCallback(){return this.callbackQueue[0]}};t.Dialog=e=>class extends e{rerouteListboxStreamToDialog({detail:{newStream:e}}){e.target==this.listboxTarget.id&&this._dialogIsOpen&&e.setAttribute("target",this.dialogListboxTarget.id)}_connectDialog(){window.visualViewport&&window.visualViewport.addEventListener("resize",this._resizeDialog)}_disconnectDialog(){window.visualViewport&&window.visualViewport.removeEventListener("resize",this._resizeDialog)}_moveArtifactsToDialog(){this.dialogComboboxTarget.value=this._fullQuery;this._actingCombobox=this.dialogComboboxTarget;this._actingListbox=this.dialogListboxTarget;this.dialogListboxTarget.append(...this.listboxTarget.children)}_moveArtifactsInline(){this.comboboxTarget.value=this._fullQuery;this._actingCombobox=this.comboboxTarget;this._actingListbox=this.listboxTarget;this.listboxTarget.append(...this.dialogListboxTarget.children)}_resizeDialog=()=>{window.visualViewport&&this.dialogTarget.style.setProperty("--hw-visual-viewport-height",`${window.visualViewport.height}px`)};_preventFocusingComboboxAfterClosingDialog(){this.dialogFocusTrapTarget.focus()}get _isSmallViewport(){return window.matchMedia(`(max-width: ${this.smallViewportMaxWidthValue})`).matches}get _dialogIsOpen(){return this.dialogTarget.open}};t.Events=e=>class extends e{_dispatchPreselectionEvent({isNewAndAllowed:e,previousValue:t}){t!==this._incomingFieldValueString&&dispatch("hw-combobox:preselection",{target:this.element,detail:{...this._eventableDetails,isNewAndAllowed:e,previousValue:t}})}_dispatchSelectionEvent(){dispatch("hw-combobox:selection",{target:this.element,detail:this._eventableDetails})}_dispatchRemovalEvent({removedDisplay:e,removedValue:t}){dispatch("hw-combobox:removal",{target:this.element,detail:{...this._eventableDetails,removedDisplay:e,removedValue:t}})}get _eventableDetails(){return{value:this._incomingFieldValueString,display:this._fullQuery,query:this._typedQuery,fieldName:this._fieldName,isValid:this._valueIsValid}}};class FetchResponse{constructor(e){this.response=e}get statusCode(){return this.response.status}get redirected(){return this.response.redirected}get ok(){return this.response.ok}get unauthenticated(){return this.statusCode===401}get unprocessableEntity(){return this.statusCode===422}get authenticationURL(){return this.response.headers.get("WWW-Authenticate")}get contentType(){const e=this.response.headers.get("Content-Type")||"";return e.replace(/;.*$/,"")}get headers(){return this.response.headers}get html(){return this.contentType.match(/^(application|text)\/(html|xhtml\+xml)$/)?this.text:Promise.reject(new Error(`Expected an HTML response but got "${this.contentType}" instead`))}get json(){return this.contentType.match(/^application\/.*json$/)?this.responseJson||(this.responseJson=this.response.json()):Promise.reject(new Error(`Expected a JSON response but got "${this.contentType}" instead`))}get text(){return this.responseText||(this.responseText=this.response.text())}get isTurboStream(){return this.contentType.match(/^text\/vnd\.turbo-stream\.html/)}async renderTurboStream(){if(!this.isTurboStream)return Promise.reject(new Error(`Expected a Turbo Stream response but got "${this.contentType}" instead`));window.Turbo?await window.Turbo.renderStreamMessage(await this.text):console.warn("You must set `window.Turbo = Turbo` to automatically process Turbo Stream events with request.js")}}class RequestInterceptor{static register(e){this.interceptor=e}static get(){return this.interceptor}static reset(){this.interceptor=void 0}}function getCookie(e){const t=document.cookie?document.cookie.split("; "):[];const i=`${encodeURIComponent(e)}=`;const s=t.find((e=>e.startsWith(i)));if(s){const e=s.split("=").slice(1).join("=");if(e)return decodeURIComponent(e)}}function compact(e){const t={};for(const i in e){const s=e[i];s!==void 0&&(t[i]=s)}return t}function metaContent(e){const t=document.head.querySelector(`meta[name="${e}"]`);return t&&t.content}function stringEntriesFromFormData(e){return[...e].reduce(((e,[t,i])=>e.concat(typeof i==="string"?[[t,i]]:[])),[])}function mergeEntries(e,t){for(const[i,s]of t)if(!(s instanceof window.File))if(e.has(i)&&!i.includes("[]")){e.delete(i);e.set(i,s)}else e.append(i,s)}class FetchRequest{constructor(e,t,i={}){this.method=e;this.options=i;this.originalUrl=t.toString()}async perform(){try{const e=RequestInterceptor.get();e&&await e(this)}catch(e){console.error(e)}const e=new FetchResponse(await window.fetch(this.url,this.fetchOptions));if(e.unauthenticated&&e.authenticationURL)return Promise.reject(window.location.href=e.authenticationURL);const t=e.ok||e.unprocessableEntity;t&&e.isTurboStream&&await e.renderTurboStream();return e}addHeader(e,t){const i=this.additionalHeaders;i[e]=t;this.options.headers=i}sameHostname(){if(!this.originalUrl.startsWith("http:"))return true;try{return new URL(this.originalUrl).hostname===window.location.hostname}catch(e){return true}}get fetchOptions(){return{method:this.method.toUpperCase(),headers:this.headers,body:this.formattedBody,signal:this.signal,credentials:this.credentials,redirect:this.redirect}}get headers(){const e={"X-Requested-With":"XMLHttpRequest","Content-Type":this.contentType,Accept:this.accept};this.sameHostname()&&(e["X-CSRF-Token"]=this.csrfToken);return compact(Object.assign(e,this.additionalHeaders))}get csrfToken(){return getCookie(metaContent("csrf-param"))||metaContent("csrf-token")}get contentType(){return this.options.contentType?this.options.contentType:this.body==null||this.body instanceof window.FormData?void 0:this.body instanceof window.File?this.body.type:"application/json"}get accept(){switch(this.responseKind){case"html":return"text/html, application/xhtml+xml";case"turbo-stream":return"text/vnd.turbo-stream.html, text/html, application/xhtml+xml";case"json":return"application/json, application/vnd.api+json";default:return"*/*"}}get body(){return this.options.body}get query(){const e=(this.originalUrl.split("?")[1]||"").split("#")[0];const t=new URLSearchParams(e);let i=this.options.query;i=i instanceof window.FormData?stringEntriesFromFormData(i):i instanceof window.URLSearchParams?i.entries():Object.entries(i||{});mergeEntries(t,i);const s=t.toString();return s.length>0?`?${s}`:""}get url(){return this.originalUrl.split("?")[0].split("#")[0]+this.query}get responseKind(){return this.options.responseKind||"html"}get signal(){return this.options.signal}get redirect(){return this.options.redirect||"follow"}get credentials(){return this.options.credentials||"same-origin"}get additionalHeaders(){return this.options.headers||{}}get formattedBody(){const e=Object.prototype.toString.call(this.body)==="[object String]";const t=this.headers["Content-Type"]==="application/json";return t&&!e?JSON.stringify(this.body):this.body}}async function get(e,t){const i=new FetchRequest("get",e,t);return i.perform()}async function post(e,t){const i=new FetchRequest("post",e,t);return i.perform()}t.Filtering=e=>class extends e{filterAndSelect({inputType:e}){this._filter(e);this._isSync&&this._selectOnQuery(e)}clear(e){this._clearQuery();this.chipDismisserTargets.forEach((e=>e.click()));e&&!e.defaultPrevented&&e.target.focus()}_initializeFiltering(){this._debouncedFilterAsync=debounce(this._debouncedFilterAsync.bind(this))}_filter(e){this._isAsync?this._debouncedFilterAsync(e):this._filterSync();this._markQueried()}_debouncedFilterAsync(e){this._filterAsync(e)}async _filterAsync(e){const t={q:this._fullQuery,input_type:e,for_id:this.element.dataset.asyncId,callback_id:this._enqueueCallback()};await get(this.asyncSrcValue,{responseKind:"turbo-stream",query:t})}_filterSync(){this._allFilterableOptionElements.forEach(applyFilter(this._fullQuery,{matching:this.filterableAttributeValue}))}_clearQuery(){this._fullQuery="";this.filterAndSelect({inputType:"deleteContentBackward"})}_markQueried(){this._forAllComboboxes((e=>e.toggleAttribute("data-queried",this._isQueried)))}get _isQueried(){return this._fullQuery.length>0}get _fullQuery(){return this._actingCombobox.value}set _fullQuery(e){this._actingCombobox.value=e}get _typedQuery(){return unselectedPortion(this._actingCombobox)}};t.FormField=e=>class extends e{get _fieldValue(){if(this._isMultiselect){const e=this.hiddenFieldTarget.value;const t=e?e.split(","):[];return new Set(t)}return this.hiddenFieldTarget.value}get _fieldValueString(){return this._isMultiselect?this._fieldValueArray.join(","):this.hiddenFieldTarget.value}get _incomingFieldValueString(){if(this._isMultiselect){const e=this._fieldValueArray;this.hiddenFieldTarget.dataset.valueForMultiselect&&e.push(this.hiddenFieldTarget.dataset.valueForMultiselect);return e.join(",")}return this.hiddenFieldTarget.value}get _fieldValueArray(){return this._isMultiselect?Array.from(this._fieldValue):[this.hiddenFieldTarget.value]}set _fieldValue(e){if(this._isMultiselect){this.hiddenFieldTarget.dataset.valueForMultiselect=e?.replace(/,/g,"");this.hiddenFieldTarget.dataset.displayForMultiselect=this._fullQuery}else this.hiddenFieldTarget.value=e}get _hasEmptyFieldValue(){return this._isMultiselect?this.hiddenFieldTarget.dataset.valueForMultiselect==""||this.hiddenFieldTarget.dataset.valueForMultiselect=="undefined":this.hiddenFieldTarget.value===""}get _hasFieldValue(){return!this._hasEmptyFieldValue}get _fieldName(){return this.hiddenFieldTarget.name}set _fieldName(e){this.hiddenFieldTarget.name=e}};t.Multiselect=e=>class extends e{navigateChip(e){this._chipKeyHandlers[e.key]?.call(this,e)}removeChip({currentTarget:e,params:t}){let i;const s=this._optionElementWithValue(t.value);if(s){i=s.getAttribute(this.autocompletableAttributeValue);this._markNotSelected(s);this._markNotMultiselected(s)}else i=t.value;this._removeFromFieldValue(t.value);this._filter("hw:multiselectSync");e.closest("[data-hw-combobox-chip]").remove();this._isSmallViewport||this.openByFocusing();this._announceToScreenReader(i,"removed");this._dispatchRemovalEvent({removedDisplay:i,removedValue:t.value})}hideChipsForCache(){this.element.querySelectorAll("[data-hw-combobox-chip]").forEach((e=>e.hidden=true))}_chipKeyHandlers={Backspace:e=>{this.removeChip(e);cancel(e)},Enter:e=>{this.removeChip(e);cancel(e)},Space:e=>{this.removeChip(e);cancel(e)},Escape:e=>{this.openByFocusing();cancel(e)}};_connectMultiselect(){if(!this._isMultiPreselected){this._preselectMultiple();this._markMultiPreselected()}}async _createChip(e){this._isMultiselect&&this._beforeClearingMultiselectQuery((async(t,i)=>{this._fullQuery="";this._filter("hw:multiselectSync");this._requestChips(i);this._addToFieldValue(i);if(e){await nextRepaint();this.openByFocusing()}this._announceToScreenReader(t,"multi-selected. Press Shift + Tab, then Enter to remove.")}))}async _requestChips(e){await post(this.selectionChipSrcValue,{responseKind:"turbo-stream",query:{for_id:this.element.dataset.asyncId,combobox_values:e}})}_beforeClearingMultiselectQuery(e){const t=this.hiddenFieldTarget.dataset.displayForMultiselect;const i=this.hiddenFieldTarget.dataset.valueForMultiselect;i&&!this._fieldValue.has(i)&&e(t,i);this.hiddenFieldTarget.dataset.displayForMultiselect="";this.hiddenFieldTarget.dataset.valueForMultiselect=""}_resetMultiselectionMarks(){this._isMultiselect&&this._fieldValueArray.forEach((e=>{const t=this._optionElementWithValue(e);if(t){t.setAttribute("data-multiselected","");t.hidden=true}}))}_markNotMultiselected(e){if(this._isMultiselect){e.removeAttribute("data-multiselected");e.hidden=false}}_addToFieldValue(e){const t=this._fieldValue;t.add(String(e));this.hiddenFieldTarget.value=Array.from(t).join(",");this._isSync&&this._resetMultiselectionMarks()}_removeFromFieldValue(e){const t=this._fieldValue;t.delete(String(e));this.hiddenFieldTarget.value=Array.from(t).join(",");this._isSync&&this._resetMultiselectionMarks()}_focusLastChipDismisser(){this.chipDismisserTargets[this.chipDismisserTargets.length-1]?.focus()}_markMultiPreselected(){this.element.dataset.multiPreselected=""}get _isMultiselect(){return this.hasSelectionChipSrcValue}get _isSingleSelect(){return!this._isMultiselect}get _isMultiPreselected(){return this.element.hasAttribute("data-multi-preselected")}};t.Navigation=e=>class extends e{navigate(e){this._autocompletesList&&this._navigationKeyHandlers[e.key]?.call(this,e)}_navigationKeyHandlers={ArrowUp:e=>{this._selectIndex(this._selectedOptionIndex-1);cancel(e)},ArrowDown:e=>{this._selectIndex(this._selectedOptionIndex+1);this._selectedOptionIndex===0&&(this._actingListbox.scrollTop=0);cancel(e)},Home:e=>{this._selectIndex(0);cancel(e)},End:e=>{this._selectIndex(this._visibleOptionElements.length-1);cancel(e)},Enter:e=>{this._closeAndBlur("hw:keyHandler:enter");cancel(e)},Escape:e=>{this._closeAndBlur("hw:keyHandler:escape");cancel(e)},Backspace:e=>{if(this._isMultiselect&&!this._fullQuery){this._focusLastChipDismisser();cancel(e)}}}};t.NewOptions=e=>class extends e{_shouldTreatAsNewOptionForFiltering(e){return e?this._isNewOptionWithNoPotentialMatches:this._isNewOptionWithPotentialMatches}get _isNewOptionWithNoPotentialMatches(){return this._isNewOptionWithPotentialMatches&&!this._isPartialAutocompleteMatch}get _isNewOptionWithPotentialMatches(){return this._isQueried&&this._allowNew&&!this._isExactAutocompleteMatch}};t.Options=e=>class extends e{_resetOptionsSilently(){this._resetOptions(this._deselect.bind(this))}_resetOptionsAndNotify(){this._resetOptions(this._deselectAndNotify.bind(this))}_resetOptions(e){this._fieldName=this.originalNameValue;e()}_optionElementWithValue(e){return this._actingListbox.querySelector(`[${this.filterableAttributeValue}][data-value='${e}']`)}_displayForOptionElement(e){return e.getAttribute(this.autocompletableAttributeValue)}get _allowNew(){return!!this.nameWhenNewValue}get _allOptions(){return Array.from(this._allFilterableOptionElements)}get _allFilterableOptionElements(){return this._actingListbox.querySelectorAll(`[${this.filterableAttributeValue}]:not([data-multiselected])`)}get _visibleOptionElements(){return[...this._allFilterableOptionElements].filter(visible)}get _selectedOptionElement(){return this._actingListbox.querySelector("[role=option][aria-selected=true]:not([data-multiselected])")}get _multiselectedOptionElements(){return this._actingListbox.querySelectorAll("[role=option][data-multiselected]")}get _selectedOptionIndex(){return[...this._visibleOptionElements].indexOf(this._selectedOptionElement)}get _isUnjustifiablyBlank(){const e=this._hasEmptyFieldValue;const t=!this._selectedOptionElement;return e&&t}};t.Selection=e=>class extends e{selectOnClick({currentTarget:e,inputType:t}){this._forceSelectionAndFilter(e,t);this._closeAndBlur("hw:optionRoleClick")}_connectSelection(){if(this.hasPrefilledDisplayValue){this._fullQuery=this.prefilledDisplayValue;this._markQueried()}}_selectOnQuery(e){if(this._shouldTreatAsNewOptionForFiltering(!isDeleteEvent({inputType:e})))this._selectNew();else if(isDeleteEvent({inputType:e}))this._deselect();else if(e==="hw:lockInSelection"&&this._ensurableOption)this._selectAndAutocompleteMissingPortion(this._ensurableOption);else if(this._isOpen&&this._visibleOptionElements[0])this._selectAndAutocompleteMissingPortion(this._visibleOptionElements[0]);else if(this._isOpen){this._resetOptionsAndNotify();this._markInvalid()}}_select(e,t){const i=this._fieldValueString;this._resetOptionsSilently();t(e);this._fieldValue=e.dataset.value;this._markSelected(e);this._markValid();this._dispatchPreselectionEvent({isNewAndAllowed:false,previousValue:i});e.scrollIntoView({block:"nearest"})}_selectNew(){const e=this._fieldValueString;this._resetOptionsSilently();this._fieldValue=this._fullQuery;this._fieldName=this.nameWhenNewValue;this._markValid();this._dispatchPreselectionEvent({isNewAndAllowed:true,previousValue:e})}_deselect(){const e=this._fieldValueString;this._selectedOptionElement&&this._markNotSelected(this._selectedOptionElement);this._fieldValue="";this._setActiveDescendant("");return e}_deselectAndNotify(){const e=this._deselect();this._dispatchPreselectionEvent({isNewAndAllowed:false,previousValue:e})}_selectIndex(e){const t=wrapAroundAccess(this._visibleOptionElements,e);this._forceSelectionWithoutFiltering(t)}_preselectSingle(){if(this._isSingleSelect&&this._hasValueButNoSelection&&this._allOptions.length<100){const e=this._optionElementWithValue(this._fieldValue);e&&this._markSelected(e)}}_preselectMultiple(){if(this._isMultiselect&&this._hasValueButNoSelection){this._requestChips(this._fieldValueString);this._resetMultiselectionMarks()}}_selectAndAutocompleteMissingPortion(e){this._select(e,this._autocompleteMissingPortion.bind(this))}_selectAndAutocompleteFullQuery(e){this._select(e,this._replaceFullQueryWithAutocompletedValue.bind(this))}_forceSelectionAndFilter(e,t){this._forceSelectionWithoutFiltering(e);this._filter(t)}_forceSelectionWithoutFiltering(e){this._selectAndAutocompleteFullQuery(e)}_lockInSelection(){this._shouldLockInSelection&&this._forceSelectionAndFilter(this._ensurableOption,"hw:lockInSelection")}_markSelected(e){this.hasSelectedClass&&e.classList.add(this.selectedClass);e.setAttribute("aria-selected",true);this._setActiveDescendant(e.id)}_markNotSelected(e){this.hasSelectedClass&&e.classList.remove(this.selectedClass);e.removeAttribute("aria-selected");this._removeActiveDescendant()}_setActiveDescendant(e){this._forAllComboboxes((t=>t.setAttribute("aria-activedescendant",e)))}_removeActiveDescendant(){this._setActiveDescendant("")}get _hasValueButNoSelection(){return this._hasFieldValue&&!this._hasSelection}get _hasSelection(){this._isSingleSelect?this._selectedOptionElement:this._multiselectedOptionElements.length>0}get _shouldLockInSelection(){return this._isQueried&&!!this._ensurableOption&&!this._isNewOptionWithPotentialMatches}get _ensurableOption(){return this._selectedOptionElement||this._visibleOptionElements[0]}};function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return Array.from(e)}var s=false;if(typeof window!=="undefined"){var n={get passive(){s=true}};window.addEventListener("testPassive",null,n);window.removeEventListener("testPassive",null,n)}var o=typeof window!=="undefined"&&window.navigator&&window.navigator.platform&&(/iP(ad|hone|od)/.test(window.navigator.platform)||window.navigator.platform==="MacIntel"&&window.navigator.maxTouchPoints>1);var l=[];var r=false;var a=-1;var c=void 0;var u=void 0;var h=void 0;var d=function allowTouchMove(e){return l.some((function(t){return!(!t.options.allowTouchMove||!t.options.allowTouchMove(e))}))};var p=function preventDefault(e){var t=e||window.event;if(d(t.target))return true;if(t.touches.length>1)return true;t.preventDefault&&t.preventDefault();return false};var _=function setOverflowHidden(e){if(h===void 0){var t=!!e&&e.reserveScrollBarGap===true;var i=window.innerWidth-document.documentElement.clientWidth;if(t&&i>0){var s=parseInt(window.getComputedStyle(document.body).getPropertyValue("padding-right"),10);h=document.body.style.paddingRight;document.body.style.paddingRight=s+i+"px"}}if(c===void 0){c=document.body.style.overflow;document.body.style.overflow="hidden"}};var m=function restoreOverflowSetting(){if(h!==void 0){document.body.style.paddingRight=h;h=void 0}if(c!==void 0){document.body.style.overflow=c;c=void 0}};var g=function setPositionFixed(){return window.requestAnimationFrame((function(){if(u===void 0){u={position:document.body.style.position,top:document.body.style.top,left:document.body.style.left};var e=window,t=e.scrollY,i=e.scrollX,s=e.innerHeight;document.body.style.position="fixed";document.body.style.top=-t+"px";document.body.style.left=-i+"px";setTimeout((function(){return window.requestAnimationFrame((function(){var e=s-window.innerHeight;e&&t>=s&&(document.body.style.top=-(t+e))}))}),300)}}))};var b=function restorePositionSetting(){if(u!==void 0){var e=-parseInt(document.body.style.top,10);var t=-parseInt(document.body.style.left,10);document.body.style.position=u.position;document.body.style.top=u.top;document.body.style.left=u.left;window.scrollTo(t,e);u=void 0}};var f=function isTargetElementTotallyScrolled(e){return!!e&&e.scrollHeight-e.scrollTop<=e.clientHeight};var y=function handleScroll(e,t){var i=e.targetTouches[0].clientY-a;if(d(e.target))return false;if(t&&t.scrollTop===0&&i>0)return p(e);if(f(t)&&i<0)return p(e);e.stopPropagation();return true};var v=function disableBodyScroll(e,t){if(e){if(!l.some((function(t){return t.targetElement===e}))){var i={targetElement:e,options:t||{}};l=[].concat(_toConsumableArray(l),[i]);o?g():_(t);if(o){e.ontouchstart=function(e){e.targetTouches.length===1&&(a=e.targetTouches[0].clientY)};e.ontouchmove=function(t){t.targetTouches.length===1&&y(t,e)};if(!r){document.addEventListener("touchmove",p,s?{passive:false}:void 0);r=true}}}}else console.error("disableBodyScroll unsuccessful - targetElement must be provided when calling disableBodyScroll on IOS devices.")};var w=function enableBodyScroll(e){if(e){l=l.filter((function(t){return t.targetElement!==e}));if(o){e.ontouchstart=null;e.ontouchmove=null;if(r&&l.length===0){document.removeEventListener("touchmove",p,s?{passive:false}:void 0);r=false}}o?b():m()}else console.error("enableBodyScroll unsuccessful - targetElement must be provided when calling enableBodyScroll on IOS devices.")};t.Toggle=e=>class extends e{open(){this.expandedValue=true}openByFocusing(){this._actingCombobox.focus()}close(e){if(this._isOpen){const t=this._isMultiselect&&this._isSync&&!this._isSmallViewport&&e!="hw:clickOutside"&&e!="hw:focusOutside"&&e!="hw:asyncCloser";this._lockInSelection();this._clearInvalidQuery();this.expandedValue=false;this._dispatchSelectionEvent();e!="hw:keyHandler:escape"&&this._createChip(t);this._isSingleSelect&&this._selectedOptionElement&&this._announceToScreenReader(this._displayForOptionElement(this._selectedOptionElement),"selected")}}toggle(){this.expandedValue?this._closeAndBlur("hw:toggle"):this.openByFocusing()}closeOnClickOutside(e){const t=e.target;this._isOpen&&(this.mainWrapperTarget.contains(t)&&!this._isDialogDismisser(t)||this._withinElementBounds(e)||this._closeAndBlur("hw:clickOutside"))}closeOnFocusOutside({target:e}){this._isOpen&&(this.element.contains(e)||this._closeAndBlur("hw:focusOutside"))}clearOrToggleOnHandleClick(){if(this._isQueried){this._clearQuery();this._actingCombobox.focus()}else this.toggle()}_closeAndBlur(e){this.close(e);this._actingCombobox.blur()}_withinElementBounds(e){const{left:t,right:i,top:s,bottom:n}=this.mainWrapperTarget.getBoundingClientRect();const{clientX:o,clientY:l}=e;return o>=t&&o<=i&&l>=s&&l<=n}_isDialogDismisser(e){return e.closest("dialog")&&e.role!="combobox"}_expand(){this._isSync&&this._preselectSingle();this._autocompletesList&&this._isSmallViewport?this._openInDialog():this._openInline();this._actingCombobox.setAttribute("aria-expanded",true)}_collapse(){this._actingCombobox.setAttribute("aria-expanded",false);this._dialogIsOpen?this._closeInDialog():this._closeInline()}_openInDialog(){this._moveArtifactsToDialog();this._preventFocusingComboboxAfterClosingDialog();this._preventBodyScroll();this.dialogTarget.showModal()}_openInline(){this.listboxTarget.hidden=false}_closeInDialog(){this._moveArtifactsInline();this.dialogTarget.close();this._restoreBodyScroll();this._actingCombobox.scrollIntoView({block:"center"})}_closeInline(){this.listboxTarget.hidden=true}_preventBodyScroll(){v(this.dialogListboxTarget)}_restoreBodyScroll(){w(this.dialogListboxTarget)}_clearInvalidQuery(){if(this._isUnjustifiablyBlank){this._deselect();this._clearQuery()}}get _isOpen(){return this.expandedValue}};t.Validity=e=>class extends e{_markValid(){this._valueIsInvalid||this._forAllComboboxes((e=>{this.hasInvalidClass&&e.classList.remove(this.invalidClass);e.removeAttribute("aria-invalid");e.removeAttribute("aria-errormessage")}))}_markInvalid(){this._valueIsValid||this._forAllComboboxes((e=>{this.hasInvalidClass&&e.classList.add(this.invalidClass);e.setAttribute("aria-invalid",true);e.setAttribute("aria-errormessage",`Please select a valid option for ${e.name}`)}))}get _valueIsValid(){return!this._valueIsInvalid}get _valueIsInvalid(){const e=this.comboboxTarget.required&&this._hasEmptyFieldValue;return e}};window.HOTWIRE_COMBOBOX_STREAM_DELAY=0;const x=[e,t.Actors,t.Announcements,t.AsyncLoading,t.Autocomplete,t.Callbacks,t.Dialog,t.Events,t.Filtering,t.FormField,t.Multiselect,t.Navigation,t.NewOptions,t.Options,t.Selection,t.Toggle,t.Validity];class HwComboboxController extends(Concerns(...x)){static classes=["invalid","selected"];static targets=["announcer","combobox","chipDismisser","closer","dialog","dialogCombobox","dialogFocusTrap","dialogListbox","endOfOptionsStream","handle","hiddenField","listbox","mainWrapper"];static values={asyncSrc:String,autocompletableAttribute:String,autocomplete:String,expanded:Boolean,filterableAttribute:String,nameWhenNew:String,originalName:String,prefilledDisplay:String,selectionChipSrc:String,smallViewportMaxWidth:String};initialize(){this._initializeActors();this._initializeFiltering();this._initializeCallbacks()}connect(){this.idempotentConnect()}idempotentConnect(){this._connectSelection();this._connectMultiselect();this._connectListAutocomplete();this._connectDialog()}disconnect(){this._disconnectDialog()}expandedValueChanged(){this.expandedValue?this._expand():this._collapse()}async endOfOptionsStreamTargetConnected(e){e.dataset.callbackId?this._runCallback(e):this._preselectSingle()}async _runCallback(e){const t=e.dataset.callbackId;if(this._callbackAttemptsExceeded(t))this._dequeueCallback(t);else{this._recordCallbackAttempt(t);if(this._isNextCallback(t)){const i=e.dataset.inputType;const s=window.HOTWIRE_COMBOBOX_STREAM_DELAY;s&&await sleep(s);this._dequeueCallback(t);this._resetMultiselectionMarks();i==="hw:multiselectSync"?this.openByFocusing():i!=="hw:lockInSelection"&&this._selectOnQuery(i)}else{await nextRepaint();this._runCallback(e)}}}closerTargetConnected(){this._closeAndBlur("hw:asyncCloser")}_printStack(){const e=new Error;console.log(e.stack||e.stacktrace)}}export{HwComboboxController as default};

